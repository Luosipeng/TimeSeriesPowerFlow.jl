<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Utils API · HyDistFlow.jl</title><meta name="title" content="Utils API · HyDistFlow.jl"/><meta property="og:title" content="Utils API · HyDistFlow.jl"/><meta property="twitter:title" content="Utils API · HyDistFlow.jl"/><meta name="description" content="Documentation for HyDistFlow.jl."/><meta property="og:description" content="Documentation for HyDistFlow.jl."/><meta property="twitter:description" content="Documentation for HyDistFlow.jl."/><meta property="og:url" content="https://Luosipeng.github.io/HyDistFlow.jl/api\\utils.html"/><meta property="twitter:url" content="https://Luosipeng.github.io/HyDistFlow.jl/api\\utils.html"/><link rel="canonical" href="https://Luosipeng.github.io/HyDistFlow.jl/api\\utils.html"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Module</span><ul><li><a class="tocitem" href="../modules/overview.html">Overview</a></li><li><a class="tocitem" href="../modules/componentmodel.html">ComponentModel</a></li><li><a class="tocitem" href="../modules/utils.html">Utils</a></li><li><a class="tocitem" href="../modules/powerflow.html">PowerFlow</a></li><li><a class="tocitem" href="../modules/timedomainpowerflow.html">TimeDomainPowerFlow</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="componentmodel.html">ComponentModel API</a></li><li class="is-active"><a class="tocitem" href="utils.html">Utils API</a><ul class="internal"><li><a class="tocitem" href="#Input-Interface"><span>Input Interface</span></a></li><li><a class="tocitem" href="#Data-Structure"><span>Data Structure</span></a></li><li><a class="tocitem" href="#Inner-Interface"><span>Inner Interface</span></a></li><li><a class="tocitem" href="#Other-Functions"><span>Other Functions</span></a></li></ul></li><li><a class="tocitem" href="powerflow.html">PowerFlow API</a></li><li><a class="tocitem" href="timedomainpowerflow.html">TimeDomainPowerFlow API</a></li><li><a class="tocitem" href="hydistflow.html">HyDistFlow API</a></li></ul></li><li><a class="tocitem" href="../references.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href="utils.html">Utils API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="utils.html">Utils API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Luosipeng/HyDistFlow.jl.git" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="github.com/Luosipeng/HyDistFlow.jl/blob/master/docs/src/api/utils.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><h2 id="Input-Interface"><a class="docs-heading-anchor" href="#Input-Interface">Input Interface</a><a id="Input-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Input-Interface" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_ac_pv_system!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_ac_pv_system!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_ac_pv_system!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_ac_pv_system!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load AC PV system data from Excel file and add to power system case. Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing AC PV system data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL3064-L3071">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_buses!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_buses!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_buses!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_buses!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load bus data from Excel file and add to power system case. Also creates mappings from bus names to integer IDs and from zone names to integer IDs.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing bus data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL185-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_converters!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_converters!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_converters!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_converters!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load converter data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing converter data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL2249-L2258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_dclines!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_dclines!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_dclines!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_dclines!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load DC line data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing DC line data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL622-L631">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_dcloads!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_dcloads!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_dcloads!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_dcloads!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load DC load data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing DC load data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL1072-L1081">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_ext_grids!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_ext_grids!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_ext_grids!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_ext_grids!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load external grid data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing external grid data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL2538-L2547">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_generators!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_generators!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_generators!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_generators!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load generator data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing generator data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL1842-L1851">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_julia_power_data-Tuple{String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_julia_power_data-Tuple{String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_julia_power_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_julia_power_data(file_path::String)</code></pre><p>Load power system data from an Excel file and convert it to a JuliaPowerCase structure.</p><p>Parameters:</p><ul><li><code>file_path::String</code>: Path to the Excel file</li></ul><p>Returns:</p><ul><li><code>JuliaPowerCase</code>: Structure containing all power system components</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_lines!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_lines!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_lines!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_lines!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load line data from Excel file and add to power system case. Uses case.bus<em>name</em>to_id to map bus names to integer IDs.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing line data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL375-L385">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_loads!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_loads!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_loads!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_loads!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load load data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing load data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL927-L936">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_pv_arrays!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_pv_arrays!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_pv_arrays!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_pv_arrays!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load PV array data from Excel file and add to power system case. Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing PV array data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL2878-L2885">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_static_generators!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_static_generators!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_static_generators!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_static_generators!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load static generator data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing static generator data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL791-L800">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_storages!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_storages!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_storages!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_storages!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load energy storage device data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing energy storage device data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL2108-L2117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_switches!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_switches!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_switches!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_switches!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load switch data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing switch data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL2712-L2721">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_trafo!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_trafo!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_trafo!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_trafo!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load two-winding transformer data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing two-winding transformer data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL1209-L1218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_trafo3ws!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_trafo3ws!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_trafo3ws!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_trafo3ws!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load three-winding transformer data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing three-winding transformer data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL1494-L1503">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_virtual_power_plants!-Tuple{JuliaPowerCase, String, String}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_virtual_power_plants!-Tuple{JuliaPowerCase, String, String}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.load_virtual_power_plants!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_virtual_power_plants!(case::JuliaPowerCase, file_path::String, sheet_name::String)</code></pre><p>Load virtual power plant (VPP) data from Excel file and add to power system case.</p><p>Parameters:</p><ul><li><code>case::JuliaPowerCase</code>: Power system case</li><li><code>file_path::String</code>: Excel file path</li><li><code>sheet_name::String</code>: Worksheet name containing virtual power plant data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL2416-L2425">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.validate_case-Tuple{JuliaPowerCase}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.validate_case-Tuple{JuliaPowerCase}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.validate_case</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">validate_case(case::JuliaPowerCase)</code></pre><p>Validate the integrity and consistency of the loaded power system case data.</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/ios/ETAPImporter.jl#LL88-L92">source</a></section></article><h2 id="Data-Structure"><a class="docs-heading-anchor" href="#Data-Structure">Data Structure</a><a id="Data-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Structure" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Definition of the JPC structure as one matrix format.
This structure represents a power system case in a one matrix format,
including buses, generators, branches, loads, and other power system components.
Each matrix is sized according to the number of attributes defined in idx.jl.</code></pre></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/Types.jl#LL247-L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Definition of the JPC_3ph structure for three-phase power flow analysis.
This structure extends the JPC format to support three-phase power flow calculations.</code></pre></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/Types.jl#LL472-L475">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JuliaPowerCase" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JuliaPowerCase"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JuliaPowerCase</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Definition of the power flow problem structure.
Aligned with JPC structure for consistency.</code></pre></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/Types.jl#LL162-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.MicrogridPlanningProblem" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.MicrogridPlanningProblem"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.MicrogridPlanningProblem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Definition of the Microgrid Planning Problem structure.    This structure contains all parameters and variables for microgrid planning optimization.</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/Types.jl#LL3-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.getindex-Tuple{HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph, String}" href="#Base.getindex-Tuple{HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph, String}"><code>Base.getindex</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getindex(jpc::JPC_3ph, key::String)</code></pre><p>Access JPC_3ph components by string key.</p><p><strong>Arguments</strong></p><ul><li><code>jpc</code>: JPC_3ph structure</li><li><code>key</code>: String key representing the component to access</li></ul><p><strong>Returns</strong></p><ul><li>The requested component data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/Types.jl#LL581-L592">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.getindex-Tuple{JPC, String}" href="#Base.getindex-Tuple{JPC, String}"><code>Base.getindex</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getindex(jpc::JPC, key::String)</code></pre><p>Access JPC components by string key.</p><p><strong>Arguments</strong></p><ul><li><code>jpc</code>: JPC structure</li><li><code>key</code>: String key representing the component to access</li></ul><p><strong>Returns</strong></p><ul><li>The requested component data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/Types.jl#LL332-L343">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.setindex!-Tuple{HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph, Any, String}" href="#Base.setindex!-Tuple{HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph, Any, String}"><code>Base.setindex!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setindex!(jpc::JPC_3ph, value, key::String)</code></pre><p>Set JPC_3ph components by string key.</p><p><strong>Arguments</strong></p><ul><li><code>jpc</code>: JPC_3ph structure</li><li><code>value</code>: Value to assign</li><li><code>key</code>: String key representing the component to modify</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/Types.jl#LL658-L667">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.setindex!-Tuple{JPC, Any, String}" href="#Base.setindex!-Tuple{JPC, Any, String}"><code>Base.setindex!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setindex!(jpc::JPC, value, key::String)</code></pre><p>Set JPC components by string key.</p><p><strong>Arguments</strong></p><ul><li><code>jpc</code>: JPC structure</li><li><code>value</code>: Value to assign</li><li><code>key</code>: String key representing the component to modify</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/Types.jl#LL403-L412">source</a></section></article><h2 id="Inner-Interface"><a class="docs-heading-anchor" href="#Inner-Interface">Inner Interface</a><a id="Inner-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Inner-Interface" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_ac_pv_system_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_ac_pv_system_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_ac_pv_system_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_ac_pv_system_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Processes AC-side photovoltaic (PV) systems from a JuliaPowerCase and converts them to JPC format.</p><p>This function extracts information about AC-connected PV systems from the input case, performs necessary calculations to determine their electrical characteristics, and stores the processed data in the JPC structure.</p><p>For each AC-side PV system, the function:</p><ol><li>Calculates operating voltages and currents based on panel configuration and conditions:<ul><li>Maximum power point voltage (Vmpp) adjusted for series-connected panels</li><li>Open-circuit voltage (Voc) adjusted for temperature and series connections</li><li>Short-circuit current (Isc) adjusted for temperature, irradiance, and parallel connections</li><li>Maximum power point current (Impp) adjusted for parallel-connected panels</li></ul></li><li>Calculates maximum power output accounting for system losses</li><li>Determines the control mode (Voltage Control or MVar Control)</li><li>Stores all parameters in a standardized matrix format</li></ol><p>The function performs the following steps:</p><ol><li>Filters the input case to identify in-service AC-side PV systems</li><li>If no in-service systems exist, returns the JPC object unchanged</li><li>Creates a matrix to store PV system data</li><li>For each PV system:<ul><li>Calculates electrical parameters based on environmental conditions</li><li>Sets control mode flags</li><li>Populates the matrix with all required parameters</li></ul></li><li>Adds the processed PV system data to the JPC object&#39;s pv_acsystem field</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing AC-side PV system data</li><li><code>jpc::JPC</code>: The JPC object where the processed PV system data will be stored</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with AC-side PV system data in the pv_acsystem field</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL1726-L1761">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_branch_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_branch_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_branch_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_battery_branch_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Processes battery storage branches from a JuliaPowerCase and converts them to JPC format.</p><p>This function creates DC branch connections between virtual battery buses and their  corresponding actual buses in the power system. Each battery is represented as a DC branch with the following characteristics:</p><ol><li>From bus: Virtual battery bus (created in JPC<em>battery</em>bus_process)</li><li>To bus: Actual bus where the battery is physically connected</li><li>Branch resistance: Calculated from battery internal resistance in per unit</li><li>Branch reactance: Set to 0 (DC branches have no reactance)</li><li>Branch rating: Based on battery package size and open-circuit voltage</li><li>Branch status: 1.0 if in service, 0.0 if not</li><li>Angle limits: Set to -360° and 360°</li></ol><p>The function performs the following steps:</p><ol><li>Creates a deep copy of the battery storage data</li><li>If no batteries exist, returns the JPC object unchanged</li><li>Initializes a matrix to store battery branch data</li><li>For each battery:<ul><li>Identifies the actual bus where the battery is connected</li><li>Calculates the virtual bus ID for the battery</li><li>Retrieves the base voltage from the actual bus</li><li>Calculates the per unit resistance using the base impedance</li><li>Sets all branch parameters including status and ratings</li></ul></li><li>Appends the processed battery branch data to the JPC object&#39;s branchDC field</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing battery storage data</li><li><code>jpc::JPC</code>: The JPC object where the battery branch data will be added</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with battery branches added to the branchDC field</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL717-L752">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_bus_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_bus_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_bus_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_battery_bus_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Processes battery storage data from a JuliaPowerCase and creates virtual DC buses for them in the JPC format.</p><p>This function extracts battery storage information from the input case, creates virtual DC buses to represent the batteries in the power system model, and appends these buses to the existing DC bus matrix in the JPC object.</p><p>Each battery is represented as a virtual DC bus with the following characteristics:</p><ol><li>Bus ID assigned sequentially after existing DC buses</li><li>Bus type set to PV node (value 2.0)</li><li>No initial power demand or generation</li><li>Voltage magnitude initialized to 1.0 p.u.</li><li>Voltage angle initialized to 0.0 degrees</li><li>Base voltage set to the battery&#39;s open-circuit voltage</li><li>Area and zone IDs set to 1.0</li><li>Voltage limits set to 0.95 (min) and 1.05 (max) p.u.</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing battery storage data</li><li><code>jpc::JPC</code>: The JPC object where the virtual battery buses will be added</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with virtual battery buses added to the busDC field</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL514-L539">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_gens_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_gens_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_gens_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_battery_gens_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Process battery storage devices and create virtual generators for them in the JPC structure.</p><p>This function creates virtual generators to represent battery storage devices in the power system model. Each battery is assigned a virtual bus and corresponding generator parameters based on its characteristics.</p><p>The function performs the following steps:</p><ol><li>Makes a deep copy of the storage devices from the input case</li><li>If no batteries exist, returns without modifications</li><li>Determines virtual node numbers based on the current busDC matrix size</li><li>Creates matrices for battery generators and storage information</li><li>For each battery:<ul><li>Assigns a virtual bus number</li><li>Calculates power capacity based on battery parameters</li><li>Sets generator parameters (power limits, voltage setpoint, status, etc.)</li><li>Configures storage-specific parameters</li></ul></li><li>Adds the battery generators to the JPC&#39;s genDC field</li><li>Adds the storage information to the JPC&#39;s storageetap field</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing battery storage data</li><li><code>jpc::JPC</code>: The JPC object where the virtual generators will be added</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with battery virtual generators added to genDC and storage information added to storageetap</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL1345-L1373">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_soc_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_soc_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_battery_soc_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_battery_soc_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Processes battery state of charge (SOC) data from a JuliaPowerCase and converts it to JPC format.</p><p>This function extracts battery storage information from the input case and creates two data structures:</p><ol><li>A battery SOC matrix containing parameters related to battery energy storage capabilities</li><li>Load entries in the loadDC matrix to represent battery connections to the power system</li></ol><p>For each battery, the following SOC parameters are stored:</p><ol><li>Bus ID where the battery is connected</li><li>Power capacity in MW (maximum charge/discharge rate)</li><li>Energy capacity in MWh</li><li>Initial state of charge (SOC)</li><li>Minimum allowable SOC</li><li>Maximum allowable SOC</li><li>Round-trip efficiency (0.0-1.0)</li><li>Status indicator (1.0 if in service, 0.0 if not)</li></ol><p>Additionally, for each battery, the function:</p><ol><li>Creates a corresponding load entry in the loadDC matrix</li><li>Sets the load ID, bus index, and status parameters</li><li>Initializes power values to zero</li></ol><p>The function performs the following steps:</p><ol><li>Creates a deep copy of the battery storage data</li><li>If no batteries exist, returns the JPC object unchanged</li><li>Initializes a matrix to store battery SOC data</li><li>Populates the SOC matrix with battery parameters</li><li>For each battery, creates a corresponding load entry in the loadDC matrix</li><li>Adds the processed battery SOC data to the JPC object&#39;s storage field</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing battery storage data</li><li><code>jpc::JPC</code>: The JPC object where the battery SOC data will be stored</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with battery SOC data in the storage field and corresponding load entries in the loadDC field</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL823-L862">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_branches_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_branches_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_branches_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_branches_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Processes AC branch data from a JuliaPowerCase and converts it to JPC format.</p><p>This function handles the calculation and conversion of various branch elements  in the power system to the format required by JPC. It processes:</p><ol><li>AC transmission lines by calling calculate<em>line</em>parameters()</li><li>Two-winding transformers by calling calculate<em>transformer2w</em>parameters()</li></ol><p>The function is structured to potentially handle different sequence components (positive, negative, zero), though the conditional logic for sequence selection is currently commented out. In its current implementation, it processes only the positive sequence components.</p><p>Note: The commented code suggests that for sequence 1 or 2 (positive or negative sequence), the function processes lines and transformers with their standard parameters, while for sequence 0 (zero sequence), it would call a different function (calculate<em>branch</em>JPC_zero).</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing branch data</li><li><code>jpc::JPC</code>: The JPC object where the processed branch data will be stored</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with branch data processed (implicitly, as the jpc object is modified in place)</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL588-L614">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_buses_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_buses_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_buses_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_buses_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Processes AC bus data from a JuliaPowerCase and converts it to JPC format.</p><p>This function extracts AC bus information from the input case, transforms it into  the standard matrix format required by JPC, and stores it in the JPC object. Each bus is represented as a row in the matrix with the following columns:</p><ol><li>Bus ID</li><li>Bus type (all initialized as PQ nodes with value 1.0)</li><li>Active power demand (PD) in MW (initialized to 0.0)</li><li>Reactive power demand (QD) in MVAR (initialized to 0.0)</li><li>Active power shunt conductance (GS) in MW (initialized to 0.0)</li><li>Reactive power shunt susceptance (BS) in MVAR (initialized to 0.0)</li><li>Area ID</li><li>Voltage magnitude (VM) in p.u. (initialized to 1.0)</li><li>Voltage angle (VA) in degrees (initialized to 0.0)</li><li>Base voltage (VN) in kV</li><li>Zone ID</li><li>Maximum voltage magnitude in p.u.</li><li>Minimum voltage magnitude in p.u.</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing bus data</li><li><code>jpc::JPC</code>: The JPC object where the processed bus data will be stored</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with the busAC field populated</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL375-L404">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_dcbranches_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_dcbranches_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_dcbranches_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_dcbranches_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Processes DC branch data from a JuliaPowerCase and converts it to JPC format.</p><p>This function extracts DC branch information from the input case, transforms it into  the standard matrix format required by JPC, and stores it in the JPC object. Each DC branch is represented as a row in the matrix with the following columns:</p><ol><li>From bus index (F_BUS)</li><li>To bus index (T_BUS)</li><li>Branch resistance in p.u. (BR_R) - calculated from length and ohms/km</li><li>Branch reactance in p.u. (BR_X) - set to 0 for DC branches</li><li>Branch rating in MVA (RATE_A) - calculated from max current or set to default</li><li>Branch status (BR_STATUS) - 1.0 if in service, 0.0 if not</li></ol><p>7-14. Various parameters including angle limits (ANGMIN, ANGMAX)</p><p>The function performs the following steps:</p><ol><li>Initializes a matrix to store DC branch data</li><li>For each DC branch in the case:<ul><li>Identifies the from and to bus indices</li><li>Calculates the base impedance using the from bus base voltage</li><li>Converts resistance from ohms to per unit values</li><li>Sets the branch parameters including status and ratings</li><li>Sets angle limits to -360° and 360°</li></ul></li><li>Appends the processed branch data to the JPC object</li><li>Processes battery branches by calling JPC<em>battery</em>branch_process</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing DC branch data</li><li><code>jpc::JPC</code>: The JPC object where the processed DC branch data will be stored</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with the branchDC field populated and battery branch data processed</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL628-L662">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_dcbuses_process-Tuple{Any, Any}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_dcbuses_process-Tuple{Any, Any}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_dcbuses_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_dcbuses_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Processes DC bus data from a JuliaPowerCase and converts it to JPC format.</p><p>This function extracts DC bus information from the input case, transforms it into  the standard matrix format required by JPC, and stores it in the JPC object. Each DC bus is represented as a row in the matrix with the following columns:</p><ol><li>Bus ID</li><li>Bus type (all initialized as PQ nodes with value 1.0)</li><li>Active power demand (PD) in MW (initialized to 0.0)</li><li>Reactive power demand (QD) in MVAR (initialized to 0.0)</li><li>Active power shunt conductance (GS) in MW (initialized to 0.0)</li><li>Reactive power shunt susceptance (BS) in MVAR (initialized to 0.0)</li><li>Area ID</li><li>Voltage magnitude (VM) in p.u. (initialized to 1.0)</li><li>Voltage angle (VA) in degrees (initialized to 0.0)</li><li>Base voltage (VN) in kV</li><li>Zone ID</li><li>Maximum voltage magnitude in p.u.</li><li>Minimum voltage magnitude in p.u.</li></ol><p>After processing the basic DC bus data, this function also calls JPC<em>battery</em>bus_process to handle battery-specific bus information.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing DC bus data</li><li><code>jpc::JPC</code>: The JPC object where the processed DC bus data will be stored</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with the busDC field populated and battery bus data processed</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL442-L474">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_dcloads_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_dcloads_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_dcloads_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_dcloads_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Process DC load data from a JuliaPowerCase and convert it to JPC format.</p><p>This function extracts information about DC loads from the input case, applies scaling factors, and stores the processed data in the JPC structure. It also updates the power demand values in the corresponding DC bus data.</p><p>For each DC load, the function:</p><ol><li>Records its basic properties (index, bus connection)</li><li>Calculates active power demand with scaling applied</li><li>Stores load model composition (ZIP model percentages)</li><li>Updates the connected DC bus with the additional power demand</li></ol><p>The function performs the following steps:</p><ol><li>Filters the input case to identify in-service DC loads</li><li>If no in-service loads exist, returns without modifications</li><li>Creates a matrix to store DC load data with 8 columns</li><li>For each DC load:<ul><li>Populates the matrix with all required parameters</li><li>Updates the corresponding bus data with the load&#39;s power demand</li></ul></li><li>Adds the processed DC load data to the JPC object&#39;s loadDC field</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing DC load data</li><li><code>jpc::JPC</code>: The JPC object where the processed DC load data will be stored</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with DC load data in the loadDC field and updated busDC power demands</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL1563-L1593">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_gens_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_gens_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_gens_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_gens_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Process generator data from a JuliaPowerCase and convert it to JPC format.</p><p>This function processes three types of generation devices:</p><ol><li>External grids (typically serving as slack/reference nodes)</li><li>Conventional generators (typically serving as PV nodes)</li><li>Static generators (typically serving as PQ nodes, but can be PV nodes if controllable)</li></ol><p>For each generation device, the function:</p><ul><li>Extracts its parameters from the input case</li><li>Converts them to the format required by JPC</li><li>Assigns appropriate bus types based on generator characteristics</li><li>Ensures proper handling of power outputs, limits, and ramp rates</li></ul><p>The function performs the following steps:</p><ol><li>Counts the number of each type of generation device</li><li>Creates a matrix to store generator data with 26 columns</li><li>Processes each type of generator and populates the matrix</li><li>Updates bus types in the JPC structure based on generator connections</li><li>Removes entries for out-of-service generators</li><li>Ensures at least one slack node exists in the system</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing generator data</li><li><code>jpc::JPC</code>: The JPC object where the processed generator data will be stored</li></ul><p><strong>Returns</strong></p><p>None. The JPC object is modified in-place.</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL1122-L1152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_inverters_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_inverters_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_inverters_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_inverters_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Process converters/inverters from a JuliaPowerCase and integrate them into the JPC format.</p><p>This function handles the conversion of power electronic converters (inverters) from the  JuliaPowerCase format to the JPC format, updating the relevant bus types and power flow parameters according to each inverter&#39;s control mode.</p><p>For each in-service inverter, the function:</p><ol><li>Determines the control mode and sets appropriate flags</li><li>Calculates AC and DC side power flows considering efficiency losses</li><li>Updates bus types for both AC and DC sides based on control mode</li><li>Creates generator entries when needed for voltage control</li><li>Updates load records for power injection/consumption</li><li>Handles ZIP load model parameters through weighted averaging</li></ol><p>The function supports the following control modes:</p><ul><li>δs_Us: Slack bus on AC side, P node on DC side</li><li>Ps_Qs: PQ node on AC side, P node on DC side</li><li>Ps_Us: PV node on AC side, P node on DC side</li><li>Udc_Qs: PQ node on AC side, slack node on DC side</li><li>Udc_Us: PV node on AC side, slack node on DC side</li><li>Droop<em>Udc</em>Qs: PQ node on AC side with droop control, slack node on DC side</li><li>Droop<em>Udc</em>Us: PV node on AC side with droop control, slack node on DC side</li></ul><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing converter data</li><li><code>jpc::JPC</code>: The JPC object where the processed converter data will be stored</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with converter data integrated into the appropriate fields</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL1816-L1848">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_loads_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_loads_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_loads_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_loads_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Process AC load data from a JuliaPowerCase and convert it to JPC format.</p><p>This function extracts information about AC loads from the input case, applies scaling factors, and stores the processed data in the JPC structure. It also updates the power demand values in the corresponding AC bus data.</p><p>For each AC load, the function:</p><ol><li>Records its basic properties (index, bus connection)</li><li>Calculates active and reactive power demand with scaling applied</li><li>Stores load model composition (ZIP model percentages)</li><li>Accumulates loads connected to the same bus</li></ol><p>The function performs the following steps:</p><ol><li>Filters the input case to identify in-service AC loads</li><li>If no in-service loads exist, returns without modifications</li><li>Creates a matrix to store AC load data with 8 columns</li><li>For each AC load:<ul><li>Calculates actual power demand with scaling applied</li><li>Populates the matrix with all required parameters</li><li>Accumulates loads by bus connection</li></ul></li><li>Adds the processed AC load data to the JPC object&#39;s loadAC field</li><li>Updates the busAC matrix with the accumulated load values for each bus</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing AC load data</li><li><code>jpc::JPC</code>: The JPC object where the processed AC load data will be stored</li></ul><p><strong>Returns</strong></p><p>None. The JPC object is modified in-place.</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL1463-L1495">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_pv_process-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_pv_process-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_pv_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_pv_process(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Process photovoltaic (PV) array data from a JuliaPowerCase and convert it to JPC format.</p><p>This function extracts information about PV arrays from the input case, performs necessary calculations to determine their electrical characteristics based on environmental conditions, and stores the processed data in the JPC structure.</p><p>For each PV array, the function:</p><ol><li>Calculates key electrical parameters adjusted for environmental conditions:<ul><li>Open-circuit voltage (Voc) adjusted for temperature and series connections</li><li>Maximum power point voltage (Vmpp) adjusted for series-connected panels</li><li>Short-circuit current (Isc) adjusted for temperature, irradiance, and parallel connections</li><li>Maximum power point current (Impp) adjusted for irradiance and parallel-connected panels</li></ul></li><li>Stores all parameters in a standardized matrix format</li></ol><p>The function performs the following steps:</p><ol><li>Filters the input case to identify in-service PV arrays</li><li>If no in-service arrays exist, returns without modifications</li><li>Creates a matrix to store PV array data with 9 columns</li><li>For each PV array:<ul><li>Calculates electrical parameters based on temperature and irradiance conditions</li><li>Populates the matrix with all required parameters</li></ul></li><li>Adds the processed PV array data to the JPC object&#39;s pv field</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing PV array data</li><li><code>jpc::JPC</code>: The JPC object where the processed PV array data will be stored</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with PV array data in the pv field</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL1638-L1670">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JuliaPowerCase2Jpc-Tuple{JuliaPowerCase}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JuliaPowerCase2Jpc-Tuple{JuliaPowerCase}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JuliaPowerCase2Jpc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JuliaPowerCase2Jpc(case::Utils.JuliaPowerCase)</code></pre><p>Converts a JuliaPowerCase object to a JPC (Julia Power Case) format for power flow analysis.</p><p>This function performs a complete transformation of the power system case data, processing all components and preparing them for power flow calculations. The conversion process includes:</p><ol><li>Merging virtual nodes to ensure a proper network topology</li><li>Creating and populating a new JPC object with the following data:<ul><li>Basic parameters (base MVA)</li><li>AC buses</li><li>DC buses</li><li>AC branches (lines and transformers)</li><li>DC branches</li><li>AC generators</li><li>Battery systems (as DC generators)</li><li>Battery state of charge data</li><li>AC loads</li><li>DC loads</li><li>PV array data</li><li>Inverters (AC/DC converters)</li><li>AC-connected PV systems</li></ul></li></ol><p><strong>Arguments</strong></p><ul><li><code>case::Utils.JuliaPowerCase</code>: The original power system case data</li></ul><p><strong>Returns</strong></p><p>A fully populated JPC object ready for power flow analysis</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL294-L324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_line_parameters-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_line_parameters-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_line_parameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>JPC<em>battery</em>soc_process(case::JuliaPowerCase, jpc::JPC) Processes battery state of charge (SOC) data from a JuliaPowerCase and converts it to JPC format. This function extracts battery storage information from the input case and creates two data structures:</p><p>A battery SOC matrix containing parameters related to battery energy storage capabilities Load entries in the loadDC matrix to represent battery connections to the power system</p><p>For each battery, the following SOC parameters are stored:</p><p>Bus ID where the battery is connected Power capacity in MW (maximum charge/discharge rate) Energy capacity in MWh Initial state of charge (SOC) Minimum allowable SOC Maximum allowable SOC Round-trip efficiency (0.0-1.0) Status indicator (1.0 if in service, 0.0 if not)</p><p>Additionally, for each battery, the function:</p><p>Creates a corresponding load entry in the loadDC matrix Sets the load ID, bus index, and status parameters Initializes power values to zero</p><p>The function performs the following steps:</p><p>Creates a deep copy of the battery storage data If no batteries exist, returns the JPC object unchanged Initializes a matrix to store battery SOC data Populates the SOC matrix with battery parameters For each battery, creates a corresponding load entry in the loadDC matrix Adds the processed battery SOC data to the JPC object&#39;s storage field</p><p>Arguments</p><p>case::JuliaPowerCase: The original power system case containing battery storage data jpc::JPC: The JPC object where the battery SOC data will be stored</p><p>Returns The updated JPC object with battery SOC data in the storage field and corresponding load entries in the loadDC field</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL915-L957">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_transformer2w_parameters-Tuple{JuliaPowerCase, JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_transformer2w_parameters-Tuple{JuliaPowerCase, JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_transformer2w_parameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_transformer2w_parameters(case::JuliaPowerCase, jpc::JPC)</code></pre><p>Processes two-winding transformer data from a JuliaPowerCase and converts it to JPC format.</p><p>This function extracts two-winding transformer information from the input case and creates branch entries in the JPC object to represent transformers in the power system model.</p><p>For each transformer, the following parameters are calculated and stored:</p><ol><li>From bus (high voltage side) and to bus (low voltage side) indices</li><li>Per-unit resistance and reactance values, adjusted to system base</li><li>Shunt susceptance (typically zero for transformers)</li><li>Tap ratio and phase shift angle</li><li>Power rating and operational status</li><li>Angle limits</li></ol><p>The function performs the following steps:</p><ol><li>Extracts two-winding transformer data from the input case</li><li>If no transformers exist, returns without modification</li><li>Creates a branch matrix to store transformer parameters</li><li>For each transformer:<ul><li>Identifies the high and low voltage bus connections</li><li>Calculates impedance parameters based on transformer specifications</li><li>Adjusts values for the system base power</li><li>Accounts for parallel transformers if present</li><li>Sets default values for tap ratio, phase shift, and other parameters</li></ul></li><li>Adds the transformer branch data to the JPC object&#39;s branchAC field</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case containing transformer data</li><li><code>jpc::JPC</code>: The JPC object where the transformer branch data will be stored</li></ul><p><strong>Returns</strong></p><p>The updated JPC object with transformer data added to the branchAC field</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL1017-L1051">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.merge_virtual_nodes-Tuple{JuliaPowerCase}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.merge_virtual_nodes-Tuple{JuliaPowerCase}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.merge_virtual_nodes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_virtual_nodes(case::JuliaPowerCase)</code></pre><p>Merges virtual nodes in a power system case and updates all connected elements.</p><p>This function identifies virtual nodes (nodes with &quot;_虚拟节点&quot; in their name),  merges them with their connected real nodes, and updates all references in the system. The process includes:</p><ol><li>Identifying virtual nodes and their connections</li><li>Creating a mapping strategy for node merging</li><li>Updating all elements (lines, transformers, circuit breakers, loads, generators)</li><li>Removing virtual nodes and their associated circuit breakers</li><li>Merging loads connected to the same bus after node consolidation</li></ol><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The original power system case</li></ul><p><strong>Returns</strong></p><p>A new JuliaPowerCase with virtual nodes merged and all references updated</p><p><strong>Note</strong></p><ul><li>Virtual nodes are identified by the substring &quot;_虚拟节点&quot; in their names</li><li>At least two connections are required for a virtual node to be merged</li><li>Self-loops created during merging are disabled</li><li>Loads at the same bus after merging are consolidated into a single load</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL25-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.resolve_node_mapping-Tuple{Any, Any}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.resolve_node_mapping-Tuple{Any, Any}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.resolve_node_mapping</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">resolve_node_mapping(node_id, node_merge_map)</code></pre><p>Resolves the final mapping of a node by traversing through a node merge map.</p><p>This function follows the chain of node mappings to find the final destination node. It handles multiple levels of redirection by iteratively looking up each node ID in the mapping until it finds a node that doesn&#39;t have a further mapping.</p><p><strong>Arguments</strong></p><ul><li><code>node_id</code>: The initial node ID to resolve</li><li><code>node_merge_map</code>: A dictionary mapping source nodes to destination nodes</li></ul><p><strong>Returns</strong></p><p>The final resolved node ID after following all mappings</p></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc.jl#LL2-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_add_grid_external_sc_impedance-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph, Int64}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_add_grid_external_sc_impedance-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph, Int64}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_add_grid_external_sc_impedance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_3ph_add_grid_external_sc_impedance(case::JuliaPowerCase, jpc_3ph::Utils.JPC_3ph, sequence::Int)</code></pre><p>Add external grid short circuit impedance to the appropriate sequence component.</p><p>This function calculates and adds short circuit impedance for external grids to the specified sequence component. For positive sequence (sequence=1), no additional impedance is added. For negative (sequence=2) and zero (sequence=0) sequences, short circuit impedance is added as shunt admittance to the connected buses.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data</li><li><code>jpc_3ph::Utils.JPC_3ph</code>: The three-phase JPC object</li><li><code>sequence::Int</code>: Sequence component identifier (0=zero, 1=positive, 2=negative)</li></ul><p><strong>Returns</strong></p><ul><li><code>jpc_3ph::Utils.JPC_3ph</code>: The updated JPC_3ph object</li><li><code>gs_eg::Vector{Float64}</code>: Conductance values for external grids (only for sequence=2)</li><li><code>bs_eg::Vector{Float64}</code>: Susceptance values for external grids (only for sequence=2)</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL1099-L1118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_branches_process-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_branches_process-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_branches_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_3ph_branches_process(case::JuliaPowerCase, jpc_3ph::Utils.JPC_3ph)</code></pre><p>Process branch data from a JuliaPowerCase and populate the JPC_3ph object with sequence component branch data.</p><p>This function calculates parameters for lines and transformers for all sequence components (positive, negative, and zero).</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data</li><li><code>jpc_3ph::Utils.JPC_3ph</code>: The three-phase JPC object to be populated</li></ul><p><strong>Returns</strong></p><ul><li><code>jpc_3ph::Utils.JPC_3ph</code>: The updated JPC_3ph object with branch data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL140-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_buses_process-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_buses_process-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_buses_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_3ph_buses_process(case::JuliaPowerCase, jpc_3ph::Utils.JPC_3ph)</code></pre><p>Process bus data from a JuliaPowerCase and populate the JPC_3ph object with sequence component bus data.</p><p>This function creates bus matrices for positive, negative, and zero sequence components. For positive sequence, voltage magnitude is initialized to 1.0 p.u., while for negative and  zero sequence components, voltage magnitude is initialized to 0.0 p.u.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data</li><li><code>jpc_3ph::Utils.JPC_3ph</code>: The three-phase JPC object to be populated</li></ul><p><strong>Returns</strong></p><ul><li><code>jpc_3ph::Utils.JPC_3ph</code>: The updated JPC_3ph object with bus data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL58-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_gens_process-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_gens_process-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_gens_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_3ph_gens_process(case::JuliaPowerCase, jpc_3ph::Utils.JPC_3ph)</code></pre><p>Process generator data from a JuliaPowerCase and populate the JPC_3ph object with sequence component generator data.</p><p>This function handles different types of generators including conventional generators, static generators, and external grids. It also sets appropriate bus types (PQ, PV, or reference) based on the generators.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data</li><li><code>jpc_3ph::Utils.JPC_3ph</code>: The three-phase JPC object to be populated</li></ul><p><strong>Side effects</strong></p><ul><li>Updates <code>jpc_3ph.genAC_1</code>, <code>jpc_3ph.genAC_2</code>, and <code>jpc_3ph.genAC_0</code> with generator data</li><li>Updates bus types in <code>jpc_3ph.busAC_1</code>, <code>jpc_3ph.busAC_2</code>, and <code>jpc_3ph.busAC_0</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL705-L720">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_loads_process-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_loads_process-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph_loads_process</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPC_3ph_loads_process(case::JuliaPowerCase, jpc_3ph::Utils.JPC_3ph)</code></pre><p>Process load data from a JuliaPowerCase and populate the JPC_3ph object with sequence component load data.</p><p>This function handles different types of loads (wye and delta connected) and distributes their power appropriately across sequence components. For balanced loads, only positive sequence components have non-zero values.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data</li><li><code>jpc_3ph::Utils.JPC_3ph</code>: The three-phase JPC object to be populated</li></ul><p><strong>Side effects</strong></p><ul><li>Updates <code>jpc_3ph.loadAC_1</code>, <code>jpc_3ph.loadAC_2</code>, and <code>jpc_3ph.loadAC_0</code> with load data</li><li>Updates PD and QD fields in bus matrices for all sequence components</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL932-L948">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JuliaPowerCase2Jpc_3ph-Tuple{JuliaPowerCase}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JuliaPowerCase2Jpc_3ph-Tuple{JuliaPowerCase}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JuliaPowerCase2Jpc_3ph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JuliaPowerCase2Jpc_3ph(case::JuliaPowerCase)</code></pre><p>Convert a JuliaPowerCase object to a three-phase JPC_3ph object.</p><p>This function processes a power system case in JuliaPowerCase format and converts it into a three-phase sequence component model (JPC_3ph) for three-phase power flow analysis.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data in JuliaPowerCase format</li></ul><p><strong>Returns</strong></p><ul><li><code>jpc_3ph::JPC_3ph</code>: The converted three-phase power system model</li><li><code>gs_eg::Vector{Float64}</code>: Conductance values for external grids</li><li><code>bs_eg::Vector{Float64}</code>: Susceptance values for external grids</li></ul><p><strong>Process</strong></p><ol><li>Merges virtual nodes</li><li>Creates a new JPC_3ph object</li><li>Sets base parameters</li><li>Processes bus data for all sequence components</li><li>Processes branch data for all sequence components</li><li>Processes generator data for all sequence components</li><li>Processes load data for all sequence components</li><li>Adds external grid short circuit impedance data</li></ol></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.add_line_sc_impedance_zero-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph, Any}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.add_line_sc_impedance_zero-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph, Any}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.add_line_sc_impedance_zero</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_line_sc_impedance_zero(case::JuliaPowerCase, jpc_3ph::Utils.JPC_3ph, branch)</code></pre><p>Add zero sequence impedance parameters for lines to the branch matrix.</p><p>This function calculates and adds zero sequence parameters for transmission lines. If specific zero sequence data is not available, it approximates using positive sequence data.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data</li><li><code>jpc_3ph::Utils.JPC_3ph</code>: The three-phase JPC object</li><li><code>branch</code>: The branch matrix to be updated with zero sequence parameters</li></ul><p><strong>Returns</strong></p><ul><li>Updated branch matrix with zero sequence line parameters</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL444-L459">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.add_trafo_sc_impedance_zero-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph, Any}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.add_trafo_sc_impedance_zero-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph, Any}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.add_trafo_sc_impedance_zero</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_trafo_sc_impedance_zero(case::JuliaPowerCase, jpc_3ph::Utils.JPC_3ph, branch)</code></pre><p>Add zero sequence impedance parameters for transformers to the branch matrix.</p><p>This function calculates and adds zero sequence parameters for two-winding transformers, considering different transformer vector groups (winding connections). For some connections, transformers are represented as shunt admittances rather than branches in the zero sequence network.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data</li><li><code>jpc_3ph::Utils.JPC_3ph</code>: The three-phase JPC object</li><li><code>branch</code>: The branch matrix to be updated with zero sequence parameters</li></ul><p><strong>Returns</strong></p><ul><li>Updated branch matrix with zero sequence transformer parameters</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL514-L530">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_3ph_line_parameters-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_3ph_line_parameters-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_3ph_line_parameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_3ph_line_parameters(case::JuliaPowerCase, jpc_3ph::Utils.JPC_3ph)</code></pre><p>Calculate line parameters for positive and negative sequence components.</p><p>This function processes line data from a JuliaPowerCase and converts it to JPC format for both positive and negative sequence components. For most lines, negative sequence parameters are equal to positive sequence parameters.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data</li><li><code>jpc_3ph::Utils.JPC_3ph</code>: The three-phase JPC object to be populated</li></ul><p><strong>Side effects</strong></p><ul><li>Updates <code>jpc_3ph.branchAC_1</code> (positive sequence) and <code>jpc_3ph.branchAC_2</code> (negative sequence)</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL166-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_3ph_transformer2w_parameters-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_3ph_transformer2w_parameters-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_3ph_transformer2w_parameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_3ph_transformer2w_parameters(case::JuliaPowerCase, jpc_3ph::Utils.JPC_3ph)</code></pre><p>Calculate two-winding transformer parameters for positive and negative sequence components.</p><p>This function processes two-winding transformer data from a JuliaPowerCase and converts it to JPC format for both positive and negative sequence components. For most transformers, negative sequence parameters are equal to positive sequence parameters.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data</li><li><code>jpc_3ph::Utils.JPC_3ph</code>: The three-phase JPC object to be populated</li></ul><p><strong>Side effects</strong></p><ul><li>Updates <code>jpc_3ph.branchAC_1</code> (positive sequence) and <code>jpc_3ph.branchAC_2</code> (negative sequence)</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL267-L282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_branch_JPC_zero-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_branch_JPC_zero-Tuple{JuliaPowerCase, HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.JPC_3ph}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.calculate_branch_JPC_zero</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_branch_JPC_zero(case::JuliaPowerCase, jpc_3ph::Utils.JPC_3ph)</code></pre><p>Calculate zero sequence branch parameters for lines and transformers.</p><p>This function creates the zero sequence branch matrix and populates it with parameters for lines and transformers. Zero sequence parameters often differ significantly from positive sequence parameters, especially for transformers with different winding connections.</p><p><strong>Arguments</strong></p><ul><li><code>case::JuliaPowerCase</code>: The power system case data</li><li><code>jpc_3ph::Utils.JPC_3ph</code>: The three-phase JPC object to be populated</li></ul><p><strong>Returns</strong></p><ul><li><code>jpc_3ph::Utils.JPC_3ph</code>: The updated JPC_3ph object with zero sequence branch data</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/juliapowercase2jpc_3ph.jl#LL401-L416">source</a></section></article><h2 id="Other-Functions"><a class="docs-heading-anchor" href="#Other-Functions">Other Functions</a><a id="Other-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.extract_islands-Tuple{JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.extract_islands-Tuple{JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.extract_islands</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">extract_islands(jpc::JPC)</code></pre><p>Extract electrically isolated islands from a power system case.</p><p>This function identifies separate electrical islands in the power system and creates individual JPC objects for each valid island. It also identifies isolated buses that don&#39;t belong to any energized island.</p><p><strong>Arguments</strong></p><ul><li><code>jpc::JPC</code>: Power system case data structure</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{JPC}</code>: List of JPC objects, each representing an energized island</li><li><code>Vector{Int}</code>: List of isolated buses (buses not connected to any energized island)</li></ul><p><strong>Notes</strong></p><ul><li>An island is considered valid/energized if it contains at least one generator or reference bus</li><li>Islands with only PQ buses and no generation are considered isolated</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/extract_island.jl#LL1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.extract_islands_acdc-Tuple{JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.extract_islands_acdc-Tuple{JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.extract_islands_acdc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">extract_islands_acdc(jpc::JPC)</code></pre><p>Extract electrically isolated islands from a hybrid AC-DC power system case.</p><p>This function identifies separate electrical islands in a hybrid AC-DC power system and creates individual JPC objects for each valid island. It handles the complexity of interconnected AC and DC subsystems through converters.</p><p><strong>Arguments</strong></p><ul><li><code>jpc::JPC</code>: Power system case data structure containing both AC and DC components</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{JPC}</code>: List of JPC objects, each representing an energized island</li><li><code>Vector{Int}</code>: List of isolated AC buses (buses not connected to any energized island)</li></ul><p><strong>Notes</strong></p><ul><li>An island is considered valid/energized if it contains at least one generator, reference bus, or has a power source in its connected DC subsystem</li><li>Islands with only PQ buses and no generation capability are considered isolated</li><li>The function checks for potential issues like multiple reference nodes or batteries in constant Vdc mode that might cause power flow calculation errors</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/extract_island.jl#LL402-L424">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.find_islands-Tuple{JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.find_islands-Tuple{JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.find_islands</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_islands(jpc::JPC)</code></pre><p>Find electrically isolated islands in an AC power system.</p><p>This function identifies connected components in the power network by analyzing the branch connections between buses. It also identifies isolated PQ buses and islands that contain only PQ buses (no generators or reference buses).</p><p><strong>Arguments</strong></p><ul><li><code>jpc::JPC</code>: Power system case data structure</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Vector{Int}}</code>: List of islands (each containing bus IDs)</li><li><code>Vector{Int}</code>: List of isolated buses (PQ buses with no connections)</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/find_island.jl#LL1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.find_islands_acdc-Tuple{JPC}" href="#HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.find_islands_acdc-Tuple{JPC}"><code>HyDistFlow.TimeDomainPowerFlow.PowerFlow.Utils.find_islands_acdc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_islands_acdc(jpc::JPC)</code></pre><p>Find electrically isolated islands in a hybrid AC-DC power system.</p><p>This function extends the island detection to handle both AC and DC subsystems, including converter connections between them. It identifies connected components across the entire network and classifies islands based on their generation capabilities.</p><p><strong>Arguments</strong></p><ul><li><code>jpc::JPC</code>: Power system case data structure containing both AC and DC components</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Vector{Int}}</code>: List of AC islands (each containing bus IDs)</li><li><code>Vector{Int}</code>: List of isolated AC buses (PQ buses with no viable connections)</li></ul><p><strong>Notes</strong></p><ul><li>Islands with only PQ buses and no generation capability (either directly or through DC connections) are considered isolated</li><li>If no DC buses exist, the function falls back to the standard AC island detection</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/Luosipeng/HyDistFlow.jl/blob/0df98cb05f37fe5c74af37fe7e0c72778867f4fc/src/Utils/src/find_island.jl#LL133-L153">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="componentmodel.html">« ComponentModel API</a><a class="docs-footer-nextpage" href="powerflow.html">PowerFlow API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Thursday 2 October 2025 20:22">Thursday 2 October 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
